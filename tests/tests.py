import unittest
from city import City
from cities import Cities

CITIES_LIST = {"cities": ["bristol"]}

# todo - place json in file
TEST_JSON = {"friday":[{"humidity":76,"precipitation":6,"pressure":996,"temperature":5,"wind_direction":"E","wind_speed":12},{"humidity":76,"precipitation":6,"pressure":996,"temperature":4,"wind_direction":"E","wind_speed":12},{"humidity":76,"precipitation":6,"pressure":996,"temperature":4,"wind_direction":"E","wind_speed":12},{"humidity":76,"precipitation":6,"pressure":996,"temperature":3,"wind_direction":"E","wind_speed":12},{"humidity":76,"precipitation":6,"pressure":996,"temperature":3,"wind_direction":"N","wind_speed":12},{"humidity":76,"precipitation":6,"pressure":996,"temperature":2,"wind_direction":"N","wind_speed":10},{"humidity":76,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"N","wind_speed":10},{"humidity":76,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"N","wind_speed":12},{"humidity":76,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"N","wind_speed":12},{"humidity":76,"precipitation":5,"pressure":996,"temperature":5,"wind_direction":"N","wind_speed":12},{"humidity":76,"precipitation":5,"pressure":996,"temperature":6,"wind_direction":"N","wind_speed":12},{"humidity":76,"precipitation":5,"pressure":996,"temperature":7,"wind_direction":"N","wind_speed":12},{"humidity":76,"precipitation":5,"pressure":996,"temperature":7,"wind_direction":"N","wind_speed":13},{"humidity":76,"precipitation":5,"pressure":996,"temperature":8,"wind_direction":"N","wind_speed":14},{"humidity":76,"precipitation":5,"pressure":996,"temperature":9,"wind_direction":"N","wind_speed":16},{"humidity":76,"precipitation":5,"pressure":996,"temperature":9,"wind_direction":"N","wind_speed":16},{"humidity":76,"precipitation":5,"pressure":996,"temperature":9,"wind_direction":"NE","wind_speed":16},{"humidity":76,"precipitation":5,"pressure":996,"temperature":8,"wind_direction":"NE","wind_speed":16},{"humidity":76,"precipitation":5,"pressure":996,"temperature":8,"wind_direction":"NE","wind_speed":16},{"humidity":77,"precipitation":6,"pressure":996,"temperature":7,"wind_direction":"NE","wind_speed":16},{"humidity":77,"precipitation":6,"pressure":996,"temperature":7,"wind_direction":"E","wind_speed":16},{"humidity":77,"precipitation":6,"pressure":996,"temperature":7,"wind_direction":"SE","wind_speed":16},{"humidity":77,"precipitation":5,"pressure":996,"temperature":6,"wind_direction":"SE","wind_speed":16},{"humidity":77,"precipitation":5,"pressure":996,"temperature":6,"wind_direction":"SE","wind_speed":17}],"monday":[{"humidity":77,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"SW","wind_speed":5},{"humidity":77,"precipitation":1,"pressure":997,"temperature":6,"wind_direction":"SW","wind_speed":5},{"humidity":77,"precipitation":1,"pressure":997,"temperature":6,"wind_direction":"SW","wind_speed":6},{"humidity":77,"precipitation":2,"pressure":997,"temperature":5,"wind_direction":"W","wind_speed":6},{"humidity":77,"precipitation":1,"pressure":997,"temperature":5,"wind_direction":"W","wind_speed":6},{"humidity":77,"precipitation":0,"pressure":997,"temperature":4,"wind_direction":"W","wind_speed":6},{"humidity":77,"precipitation":0,"pressure":997,"temperature":6,"wind_direction":"NW","wind_speed":7},{"humidity":77,"precipitation":0,"pressure":997,"temperature":6,"wind_direction":"NW","wind_speed":7},{"humidity":77,"precipitation":0,"pressure":997,"temperature":6,"wind_direction":"NW","wind_speed":9},{"humidity":78,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"NE","wind_speed":9},{"humidity":78,"precipitation":0,"pressure":997,"temperature":8,"wind_direction":"NE","wind_speed":9},{"humidity":78,"precipitation":0,"pressure":997,"temperature":9,"wind_direction":"NE","wind_speed":10},{"humidity":78,"precipitation":0,"pressure":997,"temperature":9,"wind_direction":"NE","wind_speed":11},{"humidity":78,"precipitation":0,"pressure":997,"temperature":10,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":1,"pressure":997,"temperature":11,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":11,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":11,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":10,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":10,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":1,"pressure":997,"temperature":9,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":1,"pressure":997,"temperature":9,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":9,"wind_direction":"SE","wind_speed":11},{"humidity":78,"precipitation":0,"pressure":997,"temperature":8,"wind_direction":"SE","wind_speed":11},{"humidity":78,"precipitation":0,"pressure":997,"temperature":8,"wind_direction":"S","wind_speed":11}],"saturday":[{"humidity":77,"precipitation":5,"pressure":996,"temperature":7,"wind_direction":"SE","wind_speed":16},{"humidity":77,"precipitation":5,"pressure":996,"temperature":6,"wind_direction":"SE","wind_speed":16},{"humidity":77,"precipitation":5,"pressure":996,"temperature":6,"wind_direction":"SE","wind_speed":16},{"humidity":77,"precipitation":5,"pressure":996,"temperature":5,"wind_direction":"SE","wind_speed":16},{"humidity":77,"precipitation":5,"pressure":996,"temperature":5,"wind_direction":"SE","wind_speed":14},{"humidity":77,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"SE","wind_speed":14},{"humidity":77,"precipitation":6,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":14},{"humidity":77,"precipitation":6,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":13},{"humidity":77,"precipitation":6,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":13},{"humidity":77,"precipitation":8,"pressure":996,"temperature":7,"wind_direction":"E","wind_speed":14},{"humidity":77,"precipitation":8,"pressure":996,"temperature":8,"wind_direction":"E","wind_speed":15},{"humidity":77,"precipitation":8,"pressure":996,"temperature":9,"wind_direction":"E","wind_speed":15},{"humidity":77,"precipitation":8,"pressure":996,"temperature":9,"wind_direction":"E","wind_speed":15},{"humidity":77,"precipitation":9,"pressure":996,"temperature":10,"wind_direction":"E","wind_speed":15},{"humidity":77,"precipitation":9,"pressure":996,"temperature":11,"wind_direction":"E","wind_speed":16},{"humidity":77,"precipitation":9,"pressure":996,"temperature":11,"wind_direction":"S","wind_speed":15},{"humidity":77,"precipitation":7,"pressure":996,"temperature":11,"wind_direction":"S","wind_speed":14},{"humidity":77,"precipitation":7,"pressure":996,"temperature":10,"wind_direction":"S","wind_speed":15},{"humidity":77,"precipitation":8,"pressure":996,"temperature":10,"wind_direction":"S","wind_speed":14},{"humidity":77,"precipitation":9,"pressure":996,"temperature":9,"wind_direction":"SE","wind_speed":14},{"humidity":77,"precipitation":9,"pressure":996,"temperature":9,"wind_direction":"SE","wind_speed":14},{"humidity":77,"precipitation":9,"pressure":996,"temperature":9,"wind_direction":"SE","wind_speed":14},{"humidity":77,"precipitation":9,"pressure":996,"temperature":8,"wind_direction":"SE","wind_speed":14},{"humidity":77,"precipitation":9,"pressure":996,"temperature":8,"wind_direction":"SE","wind_speed":14}],"sunday":[{"humidity":77,"precipitation":9,"pressure":996,"temperature":7,"wind_direction":"S","wind_speed":14},{"humidity":77,"precipitation":9,"pressure":996,"temperature":6,"wind_direction":"S","wind_speed":15},{"humidity":77,"precipitation":9,"pressure":996,"temperature":6,"wind_direction":"S","wind_speed":16},{"humidity":77,"precipitation":9,"pressure":996,"temperature":5,"wind_direction":"S","wind_speed":17},{"humidity":77,"precipitation":10,"pressure":996,"temperature":5,"wind_direction":"S","wind_speed":17},{"humidity":77,"precipitation":10,"pressure":996,"temperature":4,"wind_direction":"E","wind_speed":17},{"humidity":77,"precipitation":11,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":17},{"humidity":77,"precipitation":10,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":18},{"humidity":77,"precipitation":10,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":18},{"humidity":77,"precipitation":10,"pressure":996,"temperature":7,"wind_direction":"E","wind_speed":19},{"humidity":77,"precipitation":10,"pressure":996,"temperature":8,"wind_direction":"E","wind_speed":20},{"humidity":77,"precipitation":10,"pressure":996,"temperature":9,"wind_direction":"NE","wind_speed":19},{"humidity":77,"precipitation":10,"pressure":996,"temperature":9,"wind_direction":"N","wind_speed":18},{"humidity":77,"precipitation":10,"pressure":996,"temperature":10,"wind_direction":"N","wind_speed":20},{"humidity":78,"precipitation":10,"pressure":996,"temperature":11,"wind_direction":"N","wind_speed":20},{"humidity":78,"precipitation":11,"pressure":996,"temperature":11,"wind_direction":"N","wind_speed":20},{"humidity":78,"precipitation":11,"pressure":996,"temperature":11,"wind_direction":"N","wind_speed":20},{"humidity":78,"precipitation":11,"pressure":996,"temperature":10,"wind_direction":"N","wind_speed":20},{"humidity":78,"precipitation":11,"pressure":996,"temperature":10,"wind_direction":"NE","wind_speed":20},{"humidity":78,"precipitation":13,"pressure":996,"temperature":9,"wind_direction":"NE","wind_speed":20},{"humidity":78,"precipitation":13,"pressure":996,"temperature":9,"wind_direction":"NE","wind_speed":19},{"humidity":78,"precipitation":13,"pressure":996,"temperature":9,"wind_direction":"N","wind_speed":19},{"humidity":78,"precipitation":13,"pressure":996,"temperature":8,"wind_direction":"N","wind_speed":20},{"humidity":78,"precipitation":14,"pressure":996,"temperature":8,"wind_direction":"NE","wind_speed":20}],"thursday":[{"humidity":78,"precipitation":4,"pressure":996,"temperature":5,"wind_direction":"N","wind_speed":15},{"humidity":78,"precipitation":4,"pressure":996,"temperature":4,"wind_direction":"NE","wind_speed":15},{"humidity":78,"precipitation":4,"pressure":996,"temperature":4,"wind_direction":"NE","wind_speed":14},{"humidity":78,"precipitation":4,"pressure":996,"temperature":3,"wind_direction":"NE","wind_speed":14},{"humidity":78,"precipitation":6,"pressure":996,"temperature":3,"wind_direction":"N","wind_speed":14},{"humidity":77,"precipitation":6,"pressure":996,"temperature":2,"wind_direction":"NE","wind_speed":12},{"humidity":77,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"NE","wind_speed":12},{"humidity":77,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"E","wind_speed":12},{"humidity":77,"precipitation":5,"pressure":996,"temperature":4,"wind_direction":"E","wind_speed":13},{"humidity":77,"precipitation":6,"pressure":996,"temperature":5,"wind_direction":"E","wind_speed":13},{"humidity":77,"precipitation":6,"pressure":996,"temperature":6,"wind_direction":"SE","wind_speed":13},{"humidity":77,"precipitation":5,"pressure":996,"temperature":7,"wind_direction":"E","wind_speed":13},{"humidity":77,"precipitation":5,"pressure":996,"temperature":7,"wind_direction":"SE","wind_speed":13},{"humidity":77,"precipitation":5,"pressure":996,"temperature":8,"wind_direction":"SE","wind_speed":13},{"humidity":77,"precipitation":5,"pressure":996,"temperature":9,"wind_direction":"SE","wind_speed":14},{"humidity":76,"precipitation":5,"pressure":996,"temperature":9,"wind_direction":"E","wind_speed":13},{"humidity":76,"precipitation":5,"pressure":995,"temperature":9,"wind_direction":"SE","wind_speed":13},{"humidity":76,"precipitation":7,"pressure":995,"temperature":8,"wind_direction":"NE","wind_speed":13},{"humidity":76,"precipitation":7,"pressure":995,"temperature":8,"wind_direction":"NE","wind_speed":11},{"humidity":76,"precipitation":7,"pressure":996,"temperature":7,"wind_direction":"E","wind_speed":11},{"humidity":76,"precipitation":7,"pressure":996,"temperature":7,"wind_direction":"SE","wind_speed":11},{"humidity":76,"precipitation":6,"pressure":996,"temperature":7,"wind_direction":"S","wind_speed":11},{"humidity":76,"precipitation":7,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":11},{"humidity":76,"precipitation":7,"pressure":996,"temperature":6,"wind_direction":"E","wind_speed":11}],"tuesday":[{"humidity":78,"precipitation":0,"pressure":997,"temperature":8,"wind_direction":"S","wind_speed":13},{"humidity":78,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"SE","wind_speed":13},{"humidity":78,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"SE","wind_speed":13},{"humidity":78,"precipitation":0,"pressure":997,"temperature":6,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":6,"wind_direction":"S","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":5,"wind_direction":"SE","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"S","wind_speed":12},{"humidity":78,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"SE","wind_speed":13},{"humidity":78,"precipitation":0,"pressure":997,"temperature":7,"wind_direction":"SE","wind_speed":13},{"humidity":78,"precipitation":0,"pressure":997,"temperature":8,"wind_direction":"E","wind_speed":13},{"humidity":78,"precipitation":0,"pressure":997,"temperature":9,"wind_direction":"E","wind_speed":13},{"humidity":78,"precipitation":1,"pressure":997,"temperature":10,"wind_direction":"E","wind_speed":13},{"humidity":78,"precipitation":2,"pressure":997,"temperature":10,"wind_direction":"E","wind_speed":13},{"humidity":78,"precipitation":2,"pressure":997,"temperature":11,"wind_direction":"NE","wind_speed":13},{"humidity":78,"precipitation":2,"pressure":997,"temperature":12,"wind_direction":"NE","wind_speed":13},{"humidity":78,"precipitation":2,"pressure":997,"temperature":12,"wind_direction":"N","wind_speed":13},{"humidity":78,"precipitation":2,"pressure":997,"temperature":12,"wind_direction":"N","wind_speed":13},{"humidity":78,"precipitation":4,"pressure":997,"temperature":11,"wind_direction":"W","wind_speed":14},{"humidity":79,"precipitation":4,"pressure":997,"temperature":11,"wind_direction":"W","wind_speed":14},{"humidity":79,"precipitation":5,"pressure":997,"temperature":10,"wind_direction":"W","wind_speed":14},{"humidity":79,"precipitation":5,"pressure":997,"temperature":10,"wind_direction":"W","wind_speed":14},{"humidity":79,"precipitation":6,"pressure":997,"temperature":10,"wind_direction":"NW","wind_speed":14},{"humidity":79,"precipitation":6,"pressure":997,"temperature":9,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":6,"pressure":997,"temperature":9,"wind_direction":"E","wind_speed":14}],"wednesday":[{"humidity":79,"precipitation":6,"pressure":997,"temperature":8,"wind_direction":"E","wind_speed":14},{"humidity":79,"precipitation":4,"pressure":997,"temperature":7,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":3,"pressure":997,"temperature":7,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":3,"pressure":997,"temperature":6,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":3,"pressure":997,"temperature":6,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":3,"pressure":997,"temperature":5,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":3,"pressure":997,"temperature":7,"wind_direction":"NE","wind_speed":14},{"humidity":79,"precipitation":4,"pressure":997,"temperature":7,"wind_direction":"E","wind_speed":14},{"humidity":79,"precipitation":4,"pressure":997,"temperature":7,"wind_direction":"E","wind_speed":14},{"humidity":79,"precipitation":4,"pressure":997,"temperature":8,"wind_direction":"E","wind_speed":15},{"humidity":79,"precipitation":4,"pressure":997,"temperature":9,"wind_direction":"E","wind_speed":15},{"humidity":79,"precipitation":4,"pressure":996,"temperature":10,"wind_direction":"SE","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":10,"wind_direction":"SE","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":11,"wind_direction":"S","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":12,"wind_direction":"S","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":12,"wind_direction":"SW","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":12,"wind_direction":"SW","wind_speed":15},{"humidity":79,"precipitation":4,"pressure":996,"temperature":11,"wind_direction":"W","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":11,"wind_direction":"W","wind_speed":16},{"humidity":79,"precipitation":4,"pressure":996,"temperature":10,"wind_direction":"SW","wind_speed":16},{"humidity":78,"precipitation":3,"pressure":996,"temperature":10,"wind_direction":"S","wind_speed":16},{"humidity":78,"precipitation":3,"pressure":996,"temperature":10,"wind_direction":"E","wind_speed":15},{"humidity":78,"precipitation":3,"pressure":996,"temperature":9,"wind_direction":"E","wind_speed":15},{"humidity":78,"precipitation":4,"pressure":996,"temperature":9,"wind_direction":"E","wind_speed":15}]}


class WeatherApiTests(unittest.TestCase):
    cities = Cities(CITIES_LIST, 0)
    cities._cities_json["bristol"] = TEST_JSON
    cities.set_data(CITIES_LIST["cities"])

    def test_humidity(self):
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "monday", 12), 78)
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "tuesday", 0), 78)
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "wednesday", 23), 78)
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "thursday", 12), 77)
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "friday", 0), 76)
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "saturday", 12), 77)
        self.assertEqual(self.cities.cities["bristol"].get_specific_value("humidity", "sunday", 17), 78)

    # todo - more tests for each weather type

    def test_compare_query(self):
        self.assertFalse(self.cities.cities["bristol"].compare_value("humidity", ">", 80, "friday"))
        self.assertTrue(self.cities.cities["bristol"].compare_value("pressure", ">", 980, "friday"))

    def test_min_and_max_values(self):
        self.assertEqual(self.cities.max_values["humidity"][0], 79)
        self.assertEqual(self.cities.min_values["pressure"][0], 995)

    def test_median_value(self):
        self.assertEqual(self.cities.cities["bristol"].median_values["wind_speed"], 14.0)
        self.assertEqual(self.cities.cities["bristol"].median_values["precipitation"], 5.0)

    def test_snowing(self):
        self.assertFalse(self.cities.is_snowing)


if __name__ == '__main__':
    unittest.main()